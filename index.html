<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Tango â€” Production Dashboard</title>

<!-- PWA -->
<link rel="manifest" href="manifest.json">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<meta name="apple-mobile-web-app-title" content="Tango">
<link rel="apple-touch-icon" href="app-icon-192.png">
<meta name="theme-color" content="#1A1A1A">

<link rel="stylesheet" href="tango-system.css">
<style>
/* ================================================================
   DASHBOARD PAGE â€” Page-specific styles only
   Shared foundation (fonts, tokens, reset, noise, nav base,
   footer, buttons) lives in tango-system.css
   ================================================================ */


/* ============================================================ */
/* DASHBOARD LAYOUT                                              */
/* ============================================================ */
.dashboard {
  max-width: var(--max-width);
  margin: 0 auto;
  padding: 0 24px 80px;
}

/* Hero removed â€” mobile-first, no big title */


/* ============================================================ */
/* STAT CARDS ROW                                                */
/* ============================================================ */
.stat-row {
  display: grid;
  grid-template-columns: repeat(4, 1fr);
  gap: 20px;
  margin-bottom: 48px;
}
.stat-card {
  background: var(--bg);
  border-radius: 20px;
  padding: 24px;
  position: relative;
  box-shadow: 0 0 60px rgba(0,0,0,0.20);
  overflow: hidden;
}
/* Noise on stat cards â€” lighter than body (0.56) so cells feel clean */
.stat-card::before {
  content: '';
  position: absolute;
  inset: 0;
  pointer-events: none;
  z-index: 0;
  opacity: 0.25;
  mix-blend-mode: multiply;
  background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 512 512' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noise'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.9' numOctaves='4' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noise)'/%3E%3C/svg%3E");
  background-repeat: repeat;
  background-size: 512px 512px;
  border-radius: 20px;
}
.stat-card > * {
  position: relative;
  z-index: 1;
}
.stat-card__label {
  font-family: var(--font-body);
  font-size: 12px;
  font-weight: 500;
  color: var(--muted);
  text-transform: uppercase;
  letter-spacing: 0.15em;
  margin-bottom: 8px;
}
.stat-card__value {
  font-family: 'Beast', var(--font-headline);
  font-size: 36px;
  font-weight: 400;
  color: var(--text);
  letter-spacing: -0.02em;
  line-height: 1;
  margin-bottom: 4px;
}
.stat-card__delta {
  font-family: var(--font-body);
  font-size: 12px;
  font-weight: 500;
}
.stat-card__delta--up {
  color: var(--green);
}
.stat-card__delta--down {
  color: #CC0000;
}
.stat-card__delta--flat {
  color: var(--muted);
}

/* Highlighted stat card */
.stat-card--highlight {
  background: var(--yellow);
}


/* ============================================================ */
/* SECTION HEADERS                                               */
/* ============================================================ */
.section-header {
  display: flex;
  align-items: baseline;
  justify-content: space-between;
  margin-bottom: 20px;
  padding-bottom: 12px;
}
.section-header__title {
  font-family: var(--font-headline);
  font-size: 22px;
  font-weight: 700;
  color: var(--text);
  text-transform: capitalize;
}
.section-header__badge {
  font-family: var(--font-body);
  font-size: 12px;
  font-weight: 500;
  color: var(--muted);
  text-transform: uppercase;
  letter-spacing: 0.1em;
}


/* ============================================================ */
/* DATA TABLES                                                   */
/* ============================================================ */
.data-table-wrap {
  background: var(--bg);
  border-radius: 20px;
  box-shadow: 0 0 60px rgba(0,0,0,0.20);
  overflow: hidden;
  margin-bottom: 48px;
  position: relative;
}
/* Noise on table containers â€” lighter than body */
.data-table-wrap::before {
  content: '';
  position: absolute;
  inset: 0;
  pointer-events: none;
  z-index: 0;
  opacity: 0.25;
  mix-blend-mode: multiply;
  background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 512 512' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noise'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.9' numOctaves='4' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noise)'/%3E%3C/svg%3E");
  background-repeat: repeat;
  background-size: 512px 512px;
  border-radius: 20px;
}
.data-table-wrap > * {
  position: relative;
  z-index: 1;
}
.data-table {
  width: 100%;
  border-collapse: collapse;
  font-family: var(--font-body);
  font-size: 13px;
}
.data-table thead th {
  font-family: var(--font-body);
  font-size: 11px;
  font-weight: 500;
  color: var(--muted);
  text-transform: uppercase;
  letter-spacing: 0.12em;
  text-align: left;
  padding: 16px 20px 12px;
}
.data-table thead th:last-child,
.data-table tbody td:last-child {
  text-align: right;
}
.data-table tbody td {
  padding: 14px 20px;
  border-bottom: 1px dashed rgba(0,0,0,0.12);
  vertical-align: middle;
  color: var(--text);
  font-weight: 400;
}
.data-table tbody tr:last-child td {
  border-bottom: none;
}
.data-table tbody tr:hover {
  background: rgba(0,0,0,0.02);
}

/* Flavor dot in table rows */
.flavor-dot {
  display: inline-block;
  width: 10px;
  height: 10px;
  border-radius: 50%;
  border: 1px solid var(--text);
  margin-right: 8px;
  vertical-align: middle;
}

/* Bold product name column */
.data-table .col-name {
  font-family: var(--font-headline);
  font-size: 14px;
  font-weight: 700;
  text-transform: capitalize;
}

/* Numeric columns */
.data-table .col-num {
  font-variant-numeric: tabular-nums;
  font-weight: 500;
}

/* Status pill */
.status-pill {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  font-family: var(--font-body);
  font-size: 11px;
  font-weight: 500;
  text-transform: uppercase;
  letter-spacing: 0.08em;
  padding: 4px 14px;
  border-radius: 9999px;
  border: 1px solid var(--text);
  line-height: 1;
}
.status-pill--green {
  background: var(--green);
  color: var(--text);
}
.status-pill--yellow {
  background: var(--yellow);
  color: var(--text);
}
.status-pill--orange {
  background: var(--orange);
  color: var(--text);
}
.status-pill--red {
  background: #CC0000;
  color: var(--white);
}
.status-pill--muted {
  background: rgba(0,0,0,0.06);
  color: var(--muted);
}


/* ============================================================ */
/* TWO-COLUMN GRID LAYOUT                                        */
/* ============================================================ */
.grid-2col {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 24px;
  margin-bottom: 48px;
}


/* ============================================================ */
/* CHANNEL PERFORMANCE BARS                                      */
/* ============================================================ */
.channel-card {
  background: var(--bg);
  border-radius: 20px;
  box-shadow: 0 0 60px rgba(0,0,0,0.20);
  padding: 24px;
  position: relative;
  overflow: hidden;
}
.channel-card::before {
  content: '';
  position: absolute;
  inset: 0;
  pointer-events: none;
  z-index: 0;
  opacity: 0.25;
  mix-blend-mode: multiply;
  background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 512 512' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noise'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.9' numOctaves='4' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noise)'/%3E%3C/svg%3E");
  background-repeat: repeat;
  background-size: 512px 512px;
  border-radius: 20px;
}
.channel-card > * {
  position: relative;
  z-index: 1;
}

.channel-bar-row {
  display: flex;
  align-items: center;
  gap: 12px;
  margin-bottom: 16px;
}
.channel-bar-row:last-child {
  margin-bottom: 0;
}
.channel-bar__label {
  font-family: var(--font-body);
  font-size: 12px;
  font-weight: 500;
  text-transform: uppercase;
  letter-spacing: 0.08em;
  color: var(--text);
  width: 100px;
  flex-shrink: 0;
}
.channel-bar__track {
  flex: 1;
  height: 20px;
  background: rgba(0,0,0,0.06);
  border-radius: 9999px;
  border: 1px solid var(--text);
  overflow: hidden;
  position: relative;
}
.channel-bar__fill {
  height: 100%;
  border-radius: 9999px;
  transition: width 0.6s ease;
}
.channel-bar__fill--green { background: var(--green); }
.channel-bar__fill--yellow { background: var(--yellow); }
.channel-bar__fill--orange { background: var(--orange); }
.channel-bar__value {
  font-family: var(--font-body);
  font-size: 12px;
  font-weight: 700;
  color: var(--text);
  width: 60px;
  text-align: right;
  flex-shrink: 0;
}


/* ============================================================ */
/* GOAL PROGRESS CARD                                            */
/* ============================================================ */
.goal-card {
  background: var(--green);
  border-radius: 20px;
  padding: 32px;
  position: relative;
  overflow: hidden;
}
.goal-card::before {
  content: '';
  position: absolute;
  inset: 0;
  pointer-events: none;
  z-index: 0;
  opacity: 0.35;
  mix-blend-mode: multiply;
  background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 512 512' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noise'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.9' numOctaves='4' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noise)'/%3E%3C/svg%3E");
  background-repeat: repeat;
  background-size: 512px 512px;
  border-radius: 20px;
}
.goal-card > * {
  position: relative;
  z-index: 1;
}
.goal-card__label {
  font-family: var(--font-body);
  font-size: 12px;
  font-weight: 500;
  color: var(--text);
  text-transform: uppercase;
  letter-spacing: 0.15em;
  margin-bottom: 8px;
}
.goal-card__amount {
  font-family: 'Beast', var(--font-headline);
  font-size: clamp(36px, 4vw, 56px);
  font-weight: 400;
  color: var(--text);
  letter-spacing: -0.02em;
  line-height: 1;
  margin-bottom: 4px;
}
.goal-card__target {
  font-family: var(--font-body);
  font-size: 14px;
  font-weight: 400;
  color: var(--text);
  margin-bottom: 16px;
}
.goal-card__bar-track {
  width: 100%;
  height: 14px;
  background: rgba(0,0,0,0.12);
  border-radius: 9999px;
  border: 1px solid var(--text);
  overflow: hidden;
}
.goal-card__bar-fill {
  height: 100%;
  background: var(--yellow);
  border-radius: 9999px;
}


/* ============================================================ */
/* ORDER CARDS (legacy)                                          */
/* ============================================================ */
.order-card {
  background: var(--bg);
  border-radius: 20px;
  box-shadow: 0 0 60px rgba(0,0,0,0.20);
  padding: 20px;
  margin-bottom: 20px;
  position: relative;
  overflow: hidden;
}
.order-card::before {
  content: '';
  position: absolute;
  inset: 0;
  pointer-events: none;
  z-index: 0;
  opacity: 0.25;
  mix-blend-mode: multiply;
  background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 512 512' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noise'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.9' numOctaves='4' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noise)'/%3E%3C/svg%3E");
  background-repeat: repeat;
  background-size: 512px 512px;
  border-radius: 20px;
}
.order-card > * {
  position: relative;
  z-index: 1;
}
.order-card__header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  margin-bottom: 12px;
  flex-wrap: wrap;
  gap: 8px;
}
.order-card__title {
  font-family: var(--font-headline);
  font-size: 16px;
  font-weight: 700;
  text-transform: capitalize;
  color: var(--text);
}
.order-card__meta {
  font-family: var(--font-body);
  font-size: 12px;
  color: var(--muted);
  letter-spacing: 0.05em;
}
.order-card__note {
  font-family: var(--font-body);
  font-size: 12px;
  font-style: italic;
  color: var(--muted);
  margin-bottom: 12px;
}

/* ============================================================ */
/* ðŸ“¦ ORDERS PIPELINE â€” Drag & Drop Kanban                      */
/* ============================================================ */
.orders-pipeline {
  display: grid;
  grid-template-columns: repeat(4, 1fr);
  gap: 16px;
  margin-bottom: 48px;
}
@media (max-width: 900px) {
  .orders-pipeline {
    grid-template-columns: repeat(2, 1fr);
  }
}
@media (max-width: 480px) {
  .orders-pipeline {
    grid-template-columns: 1fr;
  }
}

.pipeline-col {
  min-height: 120px;
}
.pipeline-col__header {
  font-family: var(--font-body);
  font-size: 11px;
  font-weight: 500;
  text-transform: uppercase;
  letter-spacing: 0.12em;
  color: var(--muted);
  padding-bottom: 10px;
  margin-bottom: 12px;
  border-bottom: 2px solid var(--text);
  display: flex;
  align-items: center;
  justify-content: space-between;
}
.pipeline-col__count {
  font-variant-numeric: tabular-nums;
  background: rgba(0,0,0,0.06);
  border-radius: 6px;
  padding: 2px 8px;
  font-size: 10px;
}
.pipeline-col__drop {
  min-height: 80px;
  border-radius: 12px;
  transition: background 0.15s;
}
.pipeline-col__drop.drag-over {
  background: rgba(255,149,0,0.08);
  outline: 2px dashed var(--orange);
  outline-offset: -2px;
}

/* Pipeline order card */
.pipe-card {
  background: var(--bg);
  border-radius: 14px;
  box-shadow: 0 2px 20px rgba(0,0,0,0.12);
  padding: 14px 16px;
  margin-bottom: 10px;
  cursor: grab;
  position: relative;
  overflow: hidden;
  border: 1px solid rgba(0,0,0,0.08);
  transition: transform 0.15s, box-shadow 0.15s;
}
.pipe-card:active {
  cursor: grabbing;
  transform: scale(1.02);
  box-shadow: 0 8px 30px rgba(0,0,0,0.20);
}
.pipe-card.dragging {
  opacity: 0.4;
}
.pipe-card::before {
  content: '';
  position: absolute;
  inset: 0;
  pointer-events: none;
  z-index: 0;
  opacity: 0.2;
  mix-blend-mode: multiply;
  background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 512 512' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noise'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.9' numOctaves='4' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noise)'/%3E%3C/svg%3E");
  background-repeat: repeat;
  background-size: 512px 512px;
  border-radius: 14px;
}
.pipe-card > * {
  position: relative;
  z-index: 1;
}
.pipe-card__channel {
  font-family: var(--font-body);
  font-size: 10px;
  font-weight: 500;
  text-transform: uppercase;
  letter-spacing: 0.1em;
  color: var(--muted);
  margin-bottom: 4px;
}
.pipe-card__title {
  font-family: var(--font-headline);
  font-size: 14px;
  font-weight: 700;
  color: var(--text);
  margin-bottom: 4px;
}
.pipe-card__value {
  font-family: var(--font-body);
  font-size: 13px;
  font-weight: 700;
  color: var(--text);
  margin-bottom: 2px;
}
.pipe-card__date {
  font-family: var(--font-body);
  font-size: 11px;
  color: var(--muted);
  margin-bottom: 8px;
}
.pipe-card__docs {
  display: flex;
  gap: 6px;
  flex-wrap: wrap;
}
.pipe-card__doc {
  font-family: var(--font-body);
  font-size: 10px;
  font-weight: 500;
  text-transform: uppercase;
  letter-spacing: 0.06em;
  padding: 3px 10px;
  border-radius: 6px;
  border: 1px solid var(--text);
  color: var(--text);
  text-decoration: none;
  transition: background 0.15s, color 0.15s;
  cursor: pointer;
}
.pipe-card__doc:hover {
  background: var(--text);
  color: var(--bg);
}
.pipe-card__doc--missing {
  border-color: rgba(0,0,0,0.15);
  color: var(--muted);
  border-style: dashed;
}
.pipe-card__doc--missing:hover {
  background: rgba(0,0,0,0.04);
  color: var(--muted);
}

/* Process flow */
.process-flow {
  font-family: var(--font-body);
  font-size: 13px;
  font-weight: 500;
  color: var(--text);
  background: rgba(0,0,0,0.04);
  border: 1px solid var(--text);
  border-radius: 12px;
  padding: 12px 16px;
  margin-bottom: 24px;
  text-align: center;
  letter-spacing: 0.02em;
}

/* Compact data table for mobile */
.data-table--compact {
  font-size: 12px;
}
.data-table--compact thead th {
  padding: 12px 14px 10px;
  font-size: 10px;
}
.data-table--compact tbody td {
  padding: 10px 14px;
}

/* ============================================================ */
/* ðŸ”¢ INVENTORY COUNTER â€” Editable quantity list                 */
/* ============================================================ */
.inv-counter {
  margin-bottom: 48px;
}
.inv-counter__group-title {
  font-family: var(--font-headline);
  font-size: 14px;
  font-weight: 700;
  text-transform: capitalize;
  color: var(--muted);
  letter-spacing: 0.1em;
  padding: 16px 0 8px;
}
.inv-counter__row {
  display: flex;
  align-items: center;
  gap: 12px;
  padding: 10px 0;
  border-bottom: 1px dashed rgba(0,0,0,0.1);
}
.inv-counter__row:last-child {
  border-bottom: none;
}
.inv-counter__label {
  flex: 1;
  font-family: var(--font-body);
  font-size: 14px;
  font-weight: 500;
  color: var(--text);
  min-width: 0;
}
.inv-counter__controls {
  display: flex;
  align-items: center;
  gap: 0;
  flex-shrink: 0;
}
.inv-counter__btn {
  width: 44px;
  height: 44px;
  border: 1px solid var(--text);
  background: var(--bg);
  font-family: var(--font-body);
  font-size: 20px;
  font-weight: 700;
  color: var(--text);
  cursor: pointer;
  display: flex;
  align-items: center;
  justify-content: center;
  -webkit-tap-highlight-color: transparent;
  user-select: none;
  transition: background 0.15s;
}
.inv-counter__btn:first-child {
  border-radius: 12px 0 0 12px;
}
.inv-counter__btn:last-child {
  border-radius: 0 12px 12px 0;
}
.inv-counter__btn:active {
  background: var(--text);
  color: var(--bg);
}
.inv-counter__value {
  width: 64px;
  height: 44px;
  border-top: 1px solid var(--text);
  border-bottom: 1px solid var(--text);
  border-left: none;
  border-right: none;
  background: var(--bg);
  font-family: var(--font-body);
  font-size: 16px;
  font-weight: 700;
  color: var(--text);
  text-align: center;
  -moz-appearance: textfield;
  appearance: textfield;
}
.inv-counter__value::-webkit-inner-spin-button,
.inv-counter__value::-webkit-outer-spin-button {
  -webkit-appearance: none;
  margin: 0;
}
.inv-counter__value:focus {
  outline: 2px solid var(--orange);
  outline-offset: -2px;
  z-index: 1;
  position: relative;
}

/* Multi-column grid for flavor items */
.inv-counter__grid {
  display: grid;
  grid-template-columns: repeat(3, 1fr);
  gap: 8px 12px;
}
@media (max-width: 600px) {
  .inv-counter__grid {
    grid-template-columns: repeat(2, 1fr);
  }
}
.inv-counter__grid .inv-counter__row {
  flex-direction: column;
  align-items: stretch;
  gap: 6px;
  padding: 8px 0;
}
.inv-counter__grid .inv-counter__label {
  font-size: 12px;
  text-align: center;
}
.inv-counter__grid .inv-counter__controls {
  justify-content: center;
}
.inv-counter__grid .inv-counter__value {
  width: 52px;
}

/* Counter card wrapper */
.inv-counter__card {
  background: var(--bg);
  border-radius: 20px;
  box-shadow: 0 0 60px rgba(0,0,0,0.20);
  padding: 20px 24px;
  position: relative;
  overflow: hidden;
}
.inv-counter__card::before {
  content: '';
  position: absolute;
  inset: 0;
  pointer-events: none;
  z-index: 0;
  opacity: 0.25;
  mix-blend-mode: multiply;
  background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 512 512' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noise'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.9' numOctaves='4' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noise)'/%3E%3C/svg%3E");
  background-repeat: repeat;
  background-size: 512px 512px;
  border-radius: 20px;
}
.inv-counter__card > * {
  position: relative;
  z-index: 1;
}

/* Timestamp */
.inv-counter__timestamp {
  font-family: var(--font-body);
  font-size: 11px;
  color: var(--muted);
  text-transform: uppercase;
  letter-spacing: 0.1em;
  text-align: right;
  padding-top: 12px;
}

/* ============================================================ */
/* RESPONSIVE                                                    */
/* ============================================================ */
@media (max-width: 900px) {
  .stat-row {
    grid-template-columns: repeat(2, 1fr);
  }
  .grid-2col {
    grid-template-columns: 1fr;
  }
}
@media (max-width: 480px) {
  .stat-row {
    grid-template-columns: 1fr;
  }
}

/* ============================================================ */
/* FLAVOR GRID TABLES â€” 6-column flavor layout                   */
/* ============================================================ */
.data-table--flavor-grid {
  table-layout: fixed;
}
.data-table--flavor-grid th:first-child {
  width: 120px;
}
.data-table--flavor-grid th:not(:first-child) {
  text-align: center;
  font-weight: 700;
  font-size: 13px;
  letter-spacing: 0.03em;
}
.data-table--flavor-grid td:not(:first-child) {
  text-align: center;
  font-family: var(--font-body);
  font-variant-numeric: tabular-nums;
}
.data-table--flavor-grid td.cell-ok {
  color: var(--green);
  font-weight: 700;
}
.data-table--flavor-grid td.cell-warn {
  color: var(--yellow);
  font-weight: 700;
}
.data-table--flavor-grid td.cell-bad {
  color: #CC0000;
  font-weight: 700;
}
.data-table--flavor-grid td.cell-zero {
  color: var(--muted);
  opacity: 0.4;
}
.data-table--flavor-grid tr.row-total td {
  font-weight: 700;
  border-top: 2px solid var(--text);
  padding-top: 10px;
}
.data-table--flavor-grid tr.row-total td:first-child {
  font-family: var(--font-headline);
  text-transform: uppercase;
  font-size: 11px;
  letter-spacing: 0.1em;
}

/* ============================================================ */
/* NEXT STEPS CARD                                               */
/* ============================================================ */
.next-steps-card {
  background: var(--bg);
  border-radius: 20px;
  box-shadow: 0 0 60px rgba(0,0,0,0.20);
  padding: 24px;
  position: relative;
  overflow: hidden;
}
.next-steps-card::before {
  content: '';
  position: absolute;
  inset: 0;
  pointer-events: none;
  z-index: 0;
  opacity: 0.25;
  mix-blend-mode: multiply;
  background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 512 512' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noise'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.9' numOctaves='4' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noise)'/%3E%3C/svg%3E");
  background-repeat: repeat;
  background-size: 512px 512px;
  border-radius: 20px;
}
.next-steps-card > * {
  position: relative;
  z-index: 1;
}
.next-step-item {
  display: flex;
  align-items: flex-start;
  gap: 12px;
  padding: 10px 0;
  border-bottom: 1px solid rgba(0,0,0,0.06);
}
.next-step-item:last-child {
  border-bottom: none;
}
.next-step-num {
  font-family: 'Beast', var(--font-headline);
  font-size: 20px;
  color: var(--orange);
  line-height: 1.2;
  flex-shrink: 0;
  width: 24px;
}
.next-step-text {
  font-family: var(--font-body);
  font-size: 14px;
  color: var(--text);
  line-height: 1.5;
}
.next-step-text strong {
  color: var(--orange);
}
</style>
</head>
<body>

<!-- DASHBOARD HEADER -->
<div style="max-width:var(--max-width);margin:0 auto;padding:24px 24px 0;display:flex;align-items:center;gap:16px;">
  <img src="! LOGO.png" alt="Tango" style="height:40px;">
  <span style="font-family:var(--font-body);font-size:12px;font-weight:500;text-transform:uppercase;letter-spacing:0.12em;color:var(--muted);">Production Dashboard</span>
</div>

<!-- DASHBOARD CONTENT -->
<div class="dashboard" style="padding-top:24px;">

  <!-- ============================================================ -->
  <!-- ðŸ”¥ FLAVOR SNAPSHOT â€” What We Have (6 columns)                 -->
  <!-- ============================================================ -->
  <div class="section-header">
    <h2 class="section-header__title">ðŸ”¥ Flavor Snapshot</h2>
    <span class="section-header__badge" id="snapshot-date">Loadingâ€¦</span>
  </div>
  <div class="data-table-wrap">
    <table class="data-table data-table--flavor-grid" id="flavor-snapshot">
      <thead>
        <tr>
          <th></th>
          <th style="color:#CC0000;">Hot</th>
          <th style="color:#3BA226;">Mild</th>
          <th style="color:#F5D623;">Mango</th>
          <th style="color:#1A1A1A;">Truffle</th>
          <th style="color:#2B6EC2;">Sriracha</th>
          <th style="color:#F5D623;">Thai</th>
        </tr>
      </thead>
      <tbody id="snapshot-body">
        <tr><td colspan="7" style="text-align:center;color:var(--muted);padding:24px;">Loading from Supabaseâ€¦</td></tr>
      </tbody>
    </table>
  </div>

  <!-- ============================================================ -->
  <!-- ðŸ“¦ ORDER DEMAND â€” What Each Order Needs (6 columns)           -->
  <!-- ============================================================ -->
  <div class="section-header" style="margin-top:32px;">
    <h2 class="section-header__title">ðŸ“¦ Order Demand</h2>
    <span class="section-header__badge">Bottles by flavor</span>
  </div>
  <div class="data-table-wrap">
    <table class="data-table data-table--flavor-grid" id="order-demand">
      <thead>
        <tr>
          <th>Order</th>
          <th style="color:#CC0000;">Hot</th>
          <th style="color:#3BA226;">Mild</th>
          <th style="color:#F5D623;">Mango</th>
          <th style="color:#1A1A1A;">Truffle</th>
          <th style="color:#2B6EC2;">Sriracha</th>
          <th style="color:#F5D623;">Thai</th>
        </tr>
      </thead>
      <tbody id="demand-body">
        <tr><td colspan="7" style="text-align:center;color:var(--muted);padding:24px;">Loadingâ€¦</td></tr>
      </tbody>
    </table>
  </div>

  <!-- ============================================================ -->
  <!-- ðŸ“Š GAP ANALYSIS â€” What We Need to Produce                     -->
  <!-- ============================================================ -->
  <div class="section-header" style="margin-top:32px;">
    <h2 class="section-header__title">ðŸ“Š Gap Analysis</h2>
    <span class="section-header__badge">Have vs Need</span>
  </div>
  <div class="data-table-wrap">
    <table class="data-table data-table--flavor-grid" id="gap-table">
      <thead>
        <tr>
          <th></th>
          <th style="color:#CC0000;">Hot</th>
          <th style="color:#3BA226;">Mild</th>
          <th style="color:#F5D623;">Mango</th>
          <th style="color:#1A1A1A;">Truffle</th>
          <th style="color:#2B6EC2;">Sriracha</th>
          <th style="color:#F5D623;">Thai</th>
        </tr>
      </thead>
      <tbody id="gap-body">
        <tr><td colspan="7" style="text-align:center;color:var(--muted);padding:24px;">Loadingâ€¦</td></tr>
      </tbody>
    </table>
  </div>

  <!-- ============================================================ -->
  <!-- ðŸ§­ NEXT STEPS â€” Smart Suggestions                            -->
  <!-- ============================================================ -->
  <div class="section-header" style="margin-top:32px;">
    <h2 class="section-header__title">ðŸ§­ Next Steps</h2>
    <span class="section-header__badge">Auto-generated</span>
  </div>
  <div class="next-steps-card" id="next-steps">
    <p style="color:var(--muted);padding:16px;">Calculatingâ€¦</p>
  </div>


  <!-- ============================================================ -->
  <!-- ðŸ“¦ ORDERS PIPELINE â€” Drag & Drop                             -->
  <!-- ============================================================ -->
  <div class="section-header">
    <h2 class="section-header__title">ðŸ“¦ Orders Pipeline</h2>
    <span class="section-header__badge">Drag to move</span>
  </div>

  <div class="orders-pipeline" id="orders-pipeline">
    <div class="pipeline-col" data-stage="new">
      <div class="pipeline-col__header">
        <span>New</span>
        <span class="pipeline-col__count" data-count>0</span>
      </div>
      <div class="pipeline-col__drop" data-drop="new"></div>
    </div>
    <div class="pipeline-col" data-stage="processing">
      <div class="pipeline-col__header">
        <span>Processing</span>
        <span class="pipeline-col__count" data-count>0</span>
      </div>
      <div class="pipeline-col__drop" data-drop="processing"></div>
    </div>
    <div class="pipeline-col" data-stage="shipped">
      <div class="pipeline-col__header">
        <span>Shipped</span>
        <span class="pipeline-col__count" data-count>0</span>
      </div>
      <div class="pipeline-col__drop" data-drop="shipped"></div>
    </div>
    <div class="pipeline-col" data-stage="paid">
      <div class="pipeline-col__header">
        <span>Paid</span>
        <span class="pipeline-col__count" data-count>0</span>
      </div>
      <div class="pipeline-col__drop" data-drop="paid"></div>
    </div>
  </div>


  <!-- (Inventory + Demand replaced by Flavor Snapshot + Order Demand + Gap Analysis above) -->


  <!-- ============================================================ -->
  <!-- ðŸ“… TIMELINE                                                   -->
  <!-- ============================================================ -->
  <div class="section-header">
    <h2 class="section-header__title">ðŸ“… Timeline</h2>
    <span class="section-header__badge">Updated Feb 8</span>
  </div>
  <div class="data-table-wrap">
    <table class="data-table data-table--compact">
      <thead><tr><th>Date</th><th>Action</th><th>Status</th></tr></thead>
      <tbody>
        <tr><td class="col-num">Jan 30</td><td>Confirm bottles, order seals</td><td><span class="status-pill status-pill--green">Done</span></td></tr>
        <tr><td class="col-num">Jan 31</td><td>Order ingredients</td><td><span class="status-pill status-pill--green">Done</span></td></tr>
        <tr><td class="col-num">Feb 3</td><td>Ingredients arrive</td><td><span class="status-pill status-pill--green">Done</span></td></tr>
        <tr><td class="col-num">Feb 4</td><td>COOK Hot + Mild (3 ollas)</td><td><span class="status-pill status-pill--green">Done</span></td></tr>
        <tr><td class="col-num">Feb 5â€“6</td><td>Cool</td><td><span class="status-pill status-pill--green">Done</span></td></tr>
        <tr><td class="col-num">Feb 7</td><td>PACK 2,248 bottles (~1,248 Hot, ~1,000 Mild)</td><td><span class="status-pill status-pill--green">Done</span></td></tr>
        <tr style="background:rgba(255,233,51,0.12);"><td class="col-num" style="font-weight:700;">Feb 9</td><td style="font-weight:700;">UNFI MOR pickup</td><td><span class="status-pill status-pill--green">Ready</span></td></tr>
        <tr style="background:rgba(255,149,0,0.12);"><td class="col-num" style="font-weight:700;">Feb 12</td><td style="font-weight:700;">PACK Mango (~204) + Truffle (~72) from drums</td><td><span class="status-pill status-pill--orange">Scheduled</span></td></tr>
        <tr><td class="col-num">TBD</td><td>COOK 2 ollas Hot + 1 olla Sriracha</td><td><span class="status-pill status-pill--red">Need Schedule</span></td></tr>
        <tr><td class="col-num">TBD+2</td><td>Cool new drums</td><td><span class="status-pill status-pill--muted">Pending</span></td></tr>
        <tr><td class="col-num">TBD+3</td><td>PACK Hot + Sriracha</td><td><span class="status-pill status-pill--muted">Pending</span></td></tr>
        <tr><td class="col-num">TBD</td><td>EXP pallet pickup</td><td><span class="status-pill status-pill--orange">Confirm Date</span></td></tr>
        <tr style="background:rgba(255,233,51,0.12);"><td class="col-num" style="font-weight:700;">Feb 25</td><td style="font-weight:700;">UNFI HVA pickup</td><td><span class="status-pill status-pill--green">Ready</span></td></tr>
      </tbody>
    </table>
  </div>


  <!-- ============================================================ -->
  <!-- ðŸ›’ WHAT WE NEED                                              -->
  <!-- ============================================================ -->
  <div class="section-header">
    <h2 class="section-header__title">ðŸ›’ What We Need</h2>
    <span class="section-header__badge">Next Cook</span>
  </div>

  <div class="grid-2col">
    <!-- Ingredients -->
    <div>
      <div class="data-table-wrap" style="margin-bottom:24px;">
        <table class="data-table data-table--compact">
          <thead><tr><th>Ingredient</th><th>Need</th><th>Have</th><th>Order</th></tr></thead>
          <tbody>
            <tr><td class="col-name">Carrots</td><td class="col-num">400 lb</td><td class="col-num">100 lb</td><td class="col-num" style="color:#CC0000; font-weight:700;">300 lb</td></tr>
            <tr><td class="col-name">Lime Juice</td><td class="col-num">5 cases</td><td class="col-num">4.5 cases</td><td class="col-num">1 case</td></tr>
            <tr><td class="col-name">Garlic</td><td class="col-num">5 cases</td><td class="col-num">1 case</td><td class="col-num" style="color:#CC0000; font-weight:700;">4 cases</td></tr>
            <tr><td class="col-name">Culantro</td><td class="col-num">3 cases</td><td class="col-num">0</td><td class="col-num" style="color:#CC0000; font-weight:700;">3 cases</td></tr>
            <tr><td class="col-name">Habanero</td><td class="col-num">5 cases</td><td class="col-num">0</td><td class="col-num" style="color:#CC0000; font-weight:700;">5 cases</td></tr>
            <tr><td class="col-name">ACV</td><td class="col-num">10 cases</td><td class="col-num">1.75</td><td class="col-num" style="color:#CC0000; font-weight:700;">8 cases</td></tr>
            <tr><td class="col-name">Salt</td><td class="col-num">1 bag</td><td class="col-num">?</td><td class="col-num">1 bag</td></tr>
          </tbody>
        </table>
      </div>
    </div>

    <!-- Shifts + Materials -->
    <div>
      <div class="data-table-wrap" style="margin-bottom:24px;">
        <table class="data-table data-table--compact">
          <thead><tr><th>Type</th><th>Hours</th><th>Cost</th></tr></thead>
          <tbody>
            <tr><td class="col-name">Cook Shift</td><td class="col-num">4 hr</td><td class="col-num">$400</td></tr>
            <tr><td class="col-name">Pack Shift</td><td class="col-num">8 hr</td><td class="col-num">$1,000</td></tr>
            <tr><td class="col-name" style="font-weight:700;">Total Labor</td><td></td><td class="col-num" style="font-weight:700;">$1,400</td></tr>
          </tbody>
        </table>
      </div>
      <div class="data-table-wrap" style="margin-bottom:24px;">
        <table class="data-table data-table--compact">
          <thead><tr><th>Material</th><th>Status</th></tr></thead>
          <tbody>
            <tr><td class="col-name">Empty Bottles</td><td>~14,750 <span class="status-pill status-pill--green" style="margin-left:8px;">Good</span></td></tr>
            <tr><td class="col-name">Caps</td><td>Have <span class="status-pill status-pill--green" style="margin-left:8px;">Good</span></td></tr>
            <tr><td class="col-name">Labels (all except Mild)</td><td>Have <span class="status-pill status-pill--green" style="margin-left:8px;">Good</span></td></tr>
            <tr><td class="col-name">Labels (Mild)</td><td>~500 left <span class="status-pill status-pill--orange" style="margin-left:8px;">Order More</span></td></tr>
            <tr><td class="col-name">Seals</td><td>OTW â€” 3,000 foil liners <span class="status-pill status-pill--yellow" style="margin-left:8px;">Shipping</span></td></tr>
            <tr><td class="col-name">6-Pack Boxes</td><td>300 XL boxes <span class="status-pill status-pill--green" style="margin-left:8px;">Good</span></td></tr>
          </tbody>
        </table>
      </div>
    </div>
  </div>


  <!-- ============================================================ -->
  <!-- COGS BY FLAVOR                                                -->
  <!-- ============================================================ -->
  <div class="section-header">
    <h2 class="section-header__title">COGS by Flavor</h2>
    <span class="section-header__badge">Jan 2026</span>
  </div>
  <div class="data-table-wrap">
    <table class="data-table">
      <thead>
        <tr>
          <th>Flavor</th>
          <th>COGS</th>
          <th>UNFI Margin</th>
          <th>Amazon Margin</th>
          <th>Best Channel</th>
          <th>Status</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td class="col-name"><span class="flavor-dot" style="background:#2B6EC2;"></span>Sriracha</td>
          <td class="col-num">$2.74</td>
          <td class="col-num">â€”</td>
          <td class="col-num">63%</td>
          <td>Amazon</td>
          <td><span class="status-pill status-pill--green">Best COGS</span></td>
        </tr>
        <tr>
          <td class="col-name"><span class="flavor-dot" style="background:#F5D623;"></span>Mango</td>
          <td class="col-num">$3.31</td>
          <td class="col-num">31%</td>
          <td class="col-num">â€”</td>
          <td>UNFI</td>
          <td><span class="status-pill status-pill--green">Best UNFI</span></td>
        </tr>
        <tr>
          <td class="col-name"><span class="flavor-dot" style="background:#1A1A1A;"></span>Truffle</td>
          <td class="col-num">$3.34</td>
          <td class="col-num">â€”</td>
          <td class="col-num">70%</td>
          <td>Amazon</td>
          <td><span class="status-pill status-pill--yellow">63% Rev</span></td>
        </tr>
        <tr>
          <td class="col-name"><span class="flavor-dot" style="background:#3BA226;"></span>Mild</td>
          <td class="col-num">$3.37</td>
          <td class="col-num">30%</td>
          <td class="col-num">55%</td>
          <td>Amazon</td>
          <td><span class="status-pill status-pill--muted">Steady</span></td>
        </tr>
        <tr>
          <td class="col-name"><span class="flavor-dot" style="background:#F5D623;"></span>Thai</td>
          <td class="col-num">$3.42</td>
          <td class="col-num">â€”</td>
          <td class="col-num">54%</td>
          <td>Amazon</td>
          <td><span class="status-pill status-pill--muted">Steady</span></td>
        </tr>
        <tr>
          <td class="col-name"><span class="flavor-dot" style="background:#CC0000;"></span>Hot</td>
          <td class="col-num">$3.49</td>
          <td class="col-num">28%</td>
          <td class="col-num">53%</td>
          <td>Amazon</td>
          <td><span class="status-pill status-pill--orange">Highest COGS</span></td>
        </tr>
      </tbody>
    </table>
  </div>


  <!-- ============================================================ -->
  <!-- TWO-COLUMN: Channel Performance + Goal Progress               -->
  <!-- ============================================================ -->
  <div class="grid-2col">

    <!-- Channel Performance -->
    <div>
      <div class="section-header">
        <h2 class="section-header__title">Channel Revenue</h2>
        <span class="section-header__badge">vs Target</span>
      </div>
      <div class="channel-card">
        <div class="channel-bar-row">
          <span class="channel-bar__label">Amazon</span>
          <div class="channel-bar__track">
            <div class="channel-bar__fill channel-bar__fill--green" style="width:35%;"></div>
          </div>
          <span class="channel-bar__value">$3,500</span>
        </div>
        <div class="channel-bar-row">
          <span class="channel-bar__label">UNFI</span>
          <div class="channel-bar__track">
            <div class="channel-bar__fill channel-bar__fill--green" style="width:34%;"></div>
          </div>
          <span class="channel-bar__value">$3,400</span>
        </div>
        <div class="channel-bar-row">
          <span class="channel-bar__label">EXP</span>
          <div class="channel-bar__track">
            <div class="channel-bar__fill channel-bar__fill--orange" style="width:26%;"></div>
          </div>
          <span class="channel-bar__value">$2,650</span>
        </div>
        <div class="channel-bar-row">
          <span class="channel-bar__label">Costco</span>
          <div class="channel-bar__track">
            <div class="channel-bar__fill channel-bar__fill--yellow" style="width:0%;"></div>
          </div>
          <span class="channel-bar__value">$0</span>
        </div>
        <div class="channel-bar-row">
          <span class="channel-bar__label">Website</span>
          <div class="channel-bar__track">
            <div class="channel-bar__fill channel-bar__fill--yellow" style="width:0%;"></div>
          </div>
          <span class="channel-bar__value">$0</span>
        </div>
        <div class="channel-bar-row">
          <span class="channel-bar__label">Faire</span>
          <div class="channel-bar__track">
            <div class="channel-bar__fill channel-bar__fill--yellow" style="width:0%;"></div>
          </div>
          <span class="channel-bar__value">$0</span>
        </div>
      </div>
    </div>

    <!-- Goal Progress -->
    <div>
      <div class="section-header">
        <h2 class="section-header__title">Q2 Goal</h2>
        <span class="section-header__badge">$50K/mo</span>
      </div>
      <div class="goal-card">
        <p class="goal-card__label">Current Monthly</p>
        <p class="goal-card__amount">$6,900</p>
        <p class="goal-card__target">of $50,000 target â€” $43,100 gap</p>
        <div class="goal-card__bar-track">
          <div class="goal-card__bar-fill" style="width:13.8%;"></div>
        </div>
      </div>
    </div>

  </div>


  <!-- ============================================================ -->
  <!-- ACTIVE BLOCKERS                                               -->
  <!-- ============================================================ -->
  <div class="section-header">
    <h2 class="section-header__title">Active Blockers</h2>
    <span class="section-header__badge">Feb 2026</span>
  </div>
  <div class="data-table-wrap">
    <table class="data-table">
      <thead>
        <tr>
          <th>Channel</th>
          <th>Blocker</th>
          <th>Impact</th>
          <th>Status</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td class="col-name">Costco</td>
          <td>Moses roadshow discussion</td>
          <td>$5K channel</td>
          <td><span class="status-pill status-pill--green">Unblocked</span></td>
        </tr>
        <tr>
          <td class="col-name">UNFI / WF</td>
          <td>John Lawson â€” SKU expansion</td>
          <td>Mango in HVA</td>
          <td><span class="status-pill status-pill--orange">Waiting</span></td>
        </tr>
        <tr>
          <td class="col-name">UNFI</td>
          <td>Endless Aisle paperwork</td>
          <td>Online orders</td>
          <td><span class="status-pill status-pill--orange">Waiting</span></td>
        </tr>
        <tr>
          <td class="col-name">Amazon</td>
          <td>PPC barely running (~$66/60d)</td>
          <td>Traffic gap</td>
          <td><span class="status-pill status-pill--red">Action Needed</span></td>
        </tr>
      </tbody>
    </table>
  </div>


  <!-- ============================================================ -->
  <!-- ðŸ”¢ INVENTORY COUNTER â€” Tap to update at the kitchen          -->
  <!-- ============================================================ -->
  <div class="section-header">
    <h2 class="section-header__title">ðŸ”¢ Quick Count</h2>
    <span class="section-header__badge">Tap to update</span>
  </div>

  <div class="inv-counter">
    <div class="inv-counter__card" id="inv-counter-card">

      <!-- BOTTLES (filled, by flavor) â€” 3-col grid -->
      <div class="inv-counter__group-title">Bottles (Filled)</div>
      <div class="inv-counter__grid">
        <div class="inv-counter__row" data-key="bottles-hot">
          <span class="inv-counter__label"><span class="flavor-dot" style="background:#CC0000;"></span> Hot</span>
          <div class="inv-counter__controls">
            <button class="inv-counter__btn" data-action="sub">âˆ’</button>
            <input class="inv-counter__value" type="number" min="0" value="442">
            <button class="inv-counter__btn" data-action="add">+</button>
          </div>
        </div>
        <div class="inv-counter__row" data-key="bottles-mild">
          <span class="inv-counter__label"><span class="flavor-dot" style="background:#3BA226;"></span> Mild</span>
          <div class="inv-counter__controls">
            <button class="inv-counter__btn" data-action="sub">âˆ’</button>
            <input class="inv-counter__value" type="number" min="0" value="502">
            <button class="inv-counter__btn" data-action="add">+</button>
          </div>
        </div>
        <div class="inv-counter__row" data-key="bottles-mango">
          <span class="inv-counter__label"><span class="flavor-dot" style="background:#F5D623;"></span> Mango</span>
          <div class="inv-counter__controls">
            <button class="inv-counter__btn" data-action="sub">âˆ’</button>
            <input class="inv-counter__value" type="number" min="0" value="48">
            <button class="inv-counter__btn" data-action="add">+</button>
          </div>
        </div>
        <div class="inv-counter__row" data-key="bottles-truffle">
          <span class="inv-counter__label"><span class="flavor-dot" style="background:#1A1A1A;"></span> Truffle</span>
          <div class="inv-counter__controls">
            <button class="inv-counter__btn" data-action="sub">âˆ’</button>
            <input class="inv-counter__value" type="number" min="0" value="0">
            <button class="inv-counter__btn" data-action="add">+</button>
          </div>
        </div>
        <div class="inv-counter__row" data-key="bottles-sriracha">
          <span class="inv-counter__label"><span class="flavor-dot" style="background:#2B6EC2;"></span> Sriracha</span>
          <div class="inv-counter__controls">
            <button class="inv-counter__btn" data-action="sub">âˆ’</button>
            <input class="inv-counter__value" type="number" min="0" value="40">
            <button class="inv-counter__btn" data-action="add">+</button>
          </div>
        </div>
        <div class="inv-counter__row" data-key="bottles-thai">
          <span class="inv-counter__label"><span class="flavor-dot" style="background:#F5D623;"></span> Thai</span>
          <div class="inv-counter__controls">
            <button class="inv-counter__btn" data-action="sub">âˆ’</button>
            <input class="inv-counter__value" type="number" min="0" value="200">
            <button class="inv-counter__btn" data-action="add">+</button>
          </div>
        </div>
      </div>

      <!-- PACKAGING â€” single items full-width -->
      <div class="inv-counter__group-title">Packaging</div>
      <div class="inv-counter__row" data-key="empty-bottles">
        <span class="inv-counter__label">Empty Bottles</span>
        <div class="inv-counter__controls">
          <button class="inv-counter__btn" data-action="sub">âˆ’</button>
          <input class="inv-counter__value" type="number" min="0" value="14750">
          <button class="inv-counter__btn" data-action="add">+</button>
        </div>
      </div>
      <div class="inv-counter__row" data-key="seals">
        <span class="inv-counter__label">Seals (Foil Liners)</span>
        <div class="inv-counter__controls">
          <button class="inv-counter__btn" data-action="sub">âˆ’</button>
          <input class="inv-counter__value" type="number" min="0" value="3000">
          <button class="inv-counter__btn" data-action="add">+</button>
        </div>
      </div>
      <div class="inv-counter__row" data-key="boxes-6pack">
        <span class="inv-counter__label">6-Pack Boxes (XL)</span>
        <div class="inv-counter__controls">
          <button class="inv-counter__btn" data-action="sub">âˆ’</button>
          <input class="inv-counter__value" type="number" min="0" value="300">
          <button class="inv-counter__btn" data-action="add">+</button>
        </div>
      </div>

      <!-- CAPS â€” by flavor, 3-col grid -->
      <div class="inv-counter__group-title">Caps</div>
      <div class="inv-counter__grid">
        <div class="inv-counter__row" data-key="caps-hot">
          <span class="inv-counter__label"><span class="flavor-dot" style="background:#CC0000;"></span> Hot</span>
          <div class="inv-counter__controls">
            <button class="inv-counter__btn" data-action="sub">âˆ’</button>
            <input class="inv-counter__value" type="number" min="0" value="0">
            <button class="inv-counter__btn" data-action="add">+</button>
          </div>
        </div>
        <div class="inv-counter__row" data-key="caps-mild">
          <span class="inv-counter__label"><span class="flavor-dot" style="background:#3BA226;"></span> Mild</span>
          <div class="inv-counter__controls">
            <button class="inv-counter__btn" data-action="sub">âˆ’</button>
            <input class="inv-counter__value" type="number" min="0" value="0">
            <button class="inv-counter__btn" data-action="add">+</button>
          </div>
        </div>
        <div class="inv-counter__row" data-key="caps-mango">
          <span class="inv-counter__label"><span class="flavor-dot" style="background:#F5D623;"></span> Mango</span>
          <div class="inv-counter__controls">
            <button class="inv-counter__btn" data-action="sub">âˆ’</button>
            <input class="inv-counter__value" type="number" min="0" value="0">
            <button class="inv-counter__btn" data-action="add">+</button>
          </div>
        </div>
        <div class="inv-counter__row" data-key="caps-truffle">
          <span class="inv-counter__label"><span class="flavor-dot" style="background:#1A1A1A;"></span> Truffle</span>
          <div class="inv-counter__controls">
            <button class="inv-counter__btn" data-action="sub">âˆ’</button>
            <input class="inv-counter__value" type="number" min="0" value="0">
            <button class="inv-counter__btn" data-action="add">+</button>
          </div>
        </div>
        <div class="inv-counter__row" data-key="caps-sriracha">
          <span class="inv-counter__label"><span class="flavor-dot" style="background:#2B6EC2;"></span> Sriracha</span>
          <div class="inv-counter__controls">
            <button class="inv-counter__btn" data-action="sub">âˆ’</button>
            <input class="inv-counter__value" type="number" min="0" value="0">
            <button class="inv-counter__btn" data-action="add">+</button>
          </div>
        </div>
        <div class="inv-counter__row" data-key="caps-thai">
          <span class="inv-counter__label"><span class="flavor-dot" style="background:#F5D623;"></span> Thai</span>
          <div class="inv-counter__controls">
            <button class="inv-counter__btn" data-action="sub">âˆ’</button>
            <input class="inv-counter__value" type="number" min="0" value="0">
            <button class="inv-counter__btn" data-action="add">+</button>
          </div>
        </div>
      </div>

      <!-- CAPS PRE-FILLED â€” full-width -->
      <div class="inv-counter__row" data-key="caps-sealed">
        <span class="inv-counter__label">Caps Pre-Filled w/ Seals (total)</span>
        <div class="inv-counter__controls">
          <button class="inv-counter__btn" data-action="sub">âˆ’</button>
          <input class="inv-counter__value" type="number" min="0" value="0">
          <button class="inv-counter__btn" data-action="add">+</button>
        </div>
      </div>

      <!-- LABELS â€” by flavor, 3-col grid -->
      <div class="inv-counter__group-title">Labels</div>
      <div class="inv-counter__grid">
        <div class="inv-counter__row" data-key="labels-hot">
          <span class="inv-counter__label"><span class="flavor-dot" style="background:#CC0000;"></span> Hot</span>
          <div class="inv-counter__controls">
            <button class="inv-counter__btn" data-action="sub">âˆ’</button>
            <input class="inv-counter__value" type="number" min="0" value="0">
            <button class="inv-counter__btn" data-action="add">+</button>
          </div>
        </div>
        <div class="inv-counter__row" data-key="labels-mild">
          <span class="inv-counter__label"><span class="flavor-dot" style="background:#3BA226;"></span> Mild</span>
          <div class="inv-counter__controls">
            <button class="inv-counter__btn" data-action="sub">âˆ’</button>
            <input class="inv-counter__value" type="number" min="0" value="500">
            <button class="inv-counter__btn" data-action="add">+</button>
          </div>
        </div>
        <div class="inv-counter__row" data-key="labels-mango">
          <span class="inv-counter__label"><span class="flavor-dot" style="background:#F5D623;"></span> Mango</span>
          <div class="inv-counter__controls">
            <button class="inv-counter__btn" data-action="sub">âˆ’</button>
            <input class="inv-counter__value" type="number" min="0" value="0">
            <button class="inv-counter__btn" data-action="add">+</button>
          </div>
        </div>
        <div class="inv-counter__row" data-key="labels-truffle">
          <span class="inv-counter__label"><span class="flavor-dot" style="background:#1A1A1A;"></span> Truffle</span>
          <div class="inv-counter__controls">
            <button class="inv-counter__btn" data-action="sub">âˆ’</button>
            <input class="inv-counter__value" type="number" min="0" value="0">
            <button class="inv-counter__btn" data-action="add">+</button>
          </div>
        </div>
        <div class="inv-counter__row" data-key="labels-sriracha">
          <span class="inv-counter__label"><span class="flavor-dot" style="background:#2B6EC2;"></span> Sriracha</span>
          <div class="inv-counter__controls">
            <button class="inv-counter__btn" data-action="sub">âˆ’</button>
            <input class="inv-counter__value" type="number" min="0" value="0">
            <button class="inv-counter__btn" data-action="add">+</button>
          </div>
        </div>
        <div class="inv-counter__row" data-key="labels-thai">
          <span class="inv-counter__label"><span class="flavor-dot" style="background:#F5D623;"></span> Thai</span>
          <div class="inv-counter__controls">
            <button class="inv-counter__btn" data-action="sub">âˆ’</button>
            <input class="inv-counter__value" type="number" min="0" value="0">
            <button class="inv-counter__btn" data-action="add">+</button>
          </div>
        </div>
      </div>

      <!-- CASE STICKERS â€” by flavor, 3-col grid -->
      <div class="inv-counter__group-title">Case Stickers</div>
      <div class="inv-counter__grid">
        <div class="inv-counter__row" data-key="stickers-hot">
          <span class="inv-counter__label"><span class="flavor-dot" style="background:#CC0000;"></span> Hot</span>
          <div class="inv-counter__controls">
            <button class="inv-counter__btn" data-action="sub">âˆ’</button>
            <input class="inv-counter__value" type="number" min="0" value="0">
            <button class="inv-counter__btn" data-action="add">+</button>
          </div>
        </div>
        <div class="inv-counter__row" data-key="stickers-mild">
          <span class="inv-counter__label"><span class="flavor-dot" style="background:#3BA226;"></span> Mild</span>
          <div class="inv-counter__controls">
            <button class="inv-counter__btn" data-action="sub">âˆ’</button>
            <input class="inv-counter__value" type="number" min="0" value="0">
            <button class="inv-counter__btn" data-action="add">+</button>
          </div>
        </div>
        <div class="inv-counter__row" data-key="stickers-mango">
          <span class="inv-counter__label"><span class="flavor-dot" style="background:#F5D623;"></span> Mango</span>
          <div class="inv-counter__controls">
            <button class="inv-counter__btn" data-action="sub">âˆ’</button>
            <input class="inv-counter__value" type="number" min="0" value="0">
            <button class="inv-counter__btn" data-action="add">+</button>
          </div>
        </div>
        <div class="inv-counter__row" data-key="stickers-truffle">
          <span class="inv-counter__label"><span class="flavor-dot" style="background:#1A1A1A;"></span> Truffle</span>
          <div class="inv-counter__controls">
            <button class="inv-counter__btn" data-action="sub">âˆ’</button>
            <input class="inv-counter__value" type="number" min="0" value="0">
            <button class="inv-counter__btn" data-action="add">+</button>
          </div>
        </div>
        <div class="inv-counter__row" data-key="stickers-sriracha">
          <span class="inv-counter__label"><span class="flavor-dot" style="background:#2B6EC2;"></span> Sriracha</span>
          <div class="inv-counter__controls">
            <button class="inv-counter__btn" data-action="sub">âˆ’</button>
            <input class="inv-counter__value" type="number" min="0" value="0">
            <button class="inv-counter__btn" data-action="add">+</button>
          </div>
        </div>
        <div class="inv-counter__row" data-key="stickers-thai">
          <span class="inv-counter__label"><span class="flavor-dot" style="background:#F5D623;"></span> Thai</span>
          <div class="inv-counter__controls">
            <button class="inv-counter__btn" data-action="sub">âˆ’</button>
            <input class="inv-counter__value" type="number" min="0" value="0">
            <button class="inv-counter__btn" data-action="add">+</button>
          </div>
        </div>
      </div>

      <!-- DRUMS â€” by flavor, 3-col grid -->
      <div class="inv-counter__group-title">Drums</div>
      <div class="inv-counter__grid">
        <div class="inv-counter__row" data-key="drums-hot">
          <span class="inv-counter__label"><span class="flavor-dot" style="background:#CC0000;"></span> Hot</span>
          <div class="inv-counter__controls">
            <button class="inv-counter__btn" data-action="sub">âˆ’</button>
            <input class="inv-counter__value" type="number" min="0" value="0">
            <button class="inv-counter__btn" data-action="add">+</button>
          </div>
        </div>
        <div class="inv-counter__row" data-key="drums-mild">
          <span class="inv-counter__label"><span class="flavor-dot" style="background:#3BA226;"></span> Mild</span>
          <div class="inv-counter__controls">
            <button class="inv-counter__btn" data-action="sub">âˆ’</button>
            <input class="inv-counter__value" type="number" min="0" value="0">
            <button class="inv-counter__btn" data-action="add">+</button>
          </div>
        </div>
        <div class="inv-counter__row" data-key="drums-mango">
          <span class="inv-counter__label"><span class="flavor-dot" style="background:#F5D623;"></span> Mango</span>
          <div class="inv-counter__controls">
            <button class="inv-counter__btn" data-action="sub">âˆ’</button>
            <input class="inv-counter__value" type="number" min="0" value="2">
            <button class="inv-counter__btn" data-action="add">+</button>
          </div>
        </div>
        <div class="inv-counter__row" data-key="drums-truffle">
          <span class="inv-counter__label"><span class="flavor-dot" style="background:#1A1A1A;"></span> Truffle</span>
          <div class="inv-counter__controls">
            <button class="inv-counter__btn" data-action="sub">âˆ’</button>
            <input class="inv-counter__value" type="number" min="0" value="1">
            <button class="inv-counter__btn" data-action="add">+</button>
          </div>
        </div>
        <div class="inv-counter__row" data-key="drums-sriracha">
          <span class="inv-counter__label"><span class="flavor-dot" style="background:#2B6EC2;"></span> Sriracha</span>
          <div class="inv-counter__controls">
            <button class="inv-counter__btn" data-action="sub">âˆ’</button>
            <input class="inv-counter__value" type="number" min="0" value="0">
            <button class="inv-counter__btn" data-action="add">+</button>
          </div>
        </div>
      </div>

      <!-- INGREDIENTS â€” 3-col grid -->
      <div class="inv-counter__group-title">Ingredients</div>
      <div class="inv-counter__grid">
        <div class="inv-counter__row" data-key="ing-carrots">
          <span class="inv-counter__label">Carrots (lb)</span>
          <div class="inv-counter__controls">
            <button class="inv-counter__btn" data-action="sub">âˆ’</button>
            <input class="inv-counter__value" type="number" min="0" value="100">
            <button class="inv-counter__btn" data-action="add">+</button>
          </div>
        </div>
        <div class="inv-counter__row" data-key="ing-lime">
          <span class="inv-counter__label">Lime Juice</span>
          <div class="inv-counter__controls">
            <button class="inv-counter__btn" data-action="sub">âˆ’</button>
            <input class="inv-counter__value" type="number" min="0" value="4">
            <button class="inv-counter__btn" data-action="add">+</button>
          </div>
        </div>
        <div class="inv-counter__row" data-key="ing-garlic">
          <span class="inv-counter__label">Garlic</span>
          <div class="inv-counter__controls">
            <button class="inv-counter__btn" data-action="sub">âˆ’</button>
            <input class="inv-counter__value" type="number" min="0" value="1">
            <button class="inv-counter__btn" data-action="add">+</button>
          </div>
        </div>
        <div class="inv-counter__row" data-key="ing-culantro">
          <span class="inv-counter__label">Culantro</span>
          <div class="inv-counter__controls">
            <button class="inv-counter__btn" data-action="sub">âˆ’</button>
            <input class="inv-counter__value" type="number" min="0" value="0">
            <button class="inv-counter__btn" data-action="add">+</button>
          </div>
        </div>
        <div class="inv-counter__row" data-key="ing-habanero">
          <span class="inv-counter__label">Habanero</span>
          <div class="inv-counter__controls">
            <button class="inv-counter__btn" data-action="sub">âˆ’</button>
            <input class="inv-counter__value" type="number" min="0" value="0">
            <button class="inv-counter__btn" data-action="add">+</button>
          </div>
        </div>
        <div class="inv-counter__row" data-key="ing-acv">
          <span class="inv-counter__label">ACV</span>
          <div class="inv-counter__controls">
            <button class="inv-counter__btn" data-action="sub">âˆ’</button>
            <input class="inv-counter__value" type="number" min="0" value="1">
            <button class="inv-counter__btn" data-action="add">+</button>
          </div>
        </div>
        <div class="inv-counter__row" data-key="ing-vinegar">
          <span class="inv-counter__label">White Vinegar</span>
          <div class="inv-counter__controls">
            <button class="inv-counter__btn" data-action="sub">âˆ’</button>
            <input class="inv-counter__value" type="number" min="0" value="3">
            <button class="inv-counter__btn" data-action="add">+</button>
          </div>
        </div>
        <div class="inv-counter__row" data-key="ing-truffle-oil">
          <span class="inv-counter__label">Truffle Flavoring</span>
          <div class="inv-counter__controls">
            <button class="inv-counter__btn" data-action="sub">âˆ’</button>
            <input class="inv-counter__value" type="number" min="0" value="0">
            <button class="inv-counter__btn" data-action="add">+</button>
          </div>
        </div>
        <div class="inv-counter__row" data-key="ing-salt">
          <span class="inv-counter__label">Salt (bags)</span>
          <div class="inv-counter__controls">
            <button class="inv-counter__btn" data-action="sub">âˆ’</button>
            <input class="inv-counter__value" type="number" min="0" value="0">
            <button class="inv-counter__btn" data-action="add">+</button>
          </div>
        </div>
      </div>

      <div class="inv-counter__timestamp" id="inv-timestamp">â€”</div>
    </div>
  </div>

  <!-- Inventory Counter JS -->
  <script>
  (function() {
    const STORAGE_KEY = 'tango-inventory';
    const TS_KEY = 'tango-inventory-ts';
    const card = document.getElementById('inv-counter-card');
    const tsEl = document.getElementById('inv-timestamp');

    // Load saved values
    function load() {
      try {
        const data = JSON.parse(localStorage.getItem(STORAGE_KEY) || '{}');
        card.querySelectorAll('.inv-counter__row').forEach(row => {
          const key = row.dataset.key;
          if (key && data[key] !== undefined) {
            row.querySelector('.inv-counter__value').value = data[key];
          }
        });
        const ts = localStorage.getItem(TS_KEY);
        if (ts) tsEl.textContent = 'Last updated: ' + ts;
      } catch(e) {}
    }

    // Save all values
    function save() {
      const data = {};
      card.querySelectorAll('.inv-counter__row').forEach(row => {
        const key = row.dataset.key;
        const val = parseInt(row.querySelector('.inv-counter__value').value) || 0;
        if (key) data[key] = val;
      });
      const now = new Date();
      const ts = now.toLocaleDateString('en-US', { month:'short', day:'numeric' })
               + ' ' + now.toLocaleTimeString('en-US', { hour:'numeric', minute:'2-digit' });
      localStorage.setItem(STORAGE_KEY, JSON.stringify(data));
      localStorage.setItem(TS_KEY, ts);
      tsEl.textContent = 'Last updated: ' + ts;
    }

    // Button clicks
    card.addEventListener('click', function(e) {
      const btn = e.target.closest('.inv-counter__btn');
      if (!btn) return;
      const input = btn.parentElement.querySelector('.inv-counter__value');
      let val = parseInt(input.value) || 0;
      if (btn.dataset.action === 'add') val++;
      else if (btn.dataset.action === 'sub' && val > 0) val--;
      input.value = val;
      save();
    });

    // Direct input edits
    card.addEventListener('input', function(e) {
      if (e.target.classList.contains('inv-counter__value')) {
        save();
      }
    });

    // Long-press for fast +/- (hold button)
    let holdTimer = null;
    let holdInterval = null;
    card.addEventListener('pointerdown', function(e) {
      const btn = e.target.closest('.inv-counter__btn');
      if (!btn) return;
      holdTimer = setTimeout(() => {
        holdInterval = setInterval(() => {
          const input = btn.parentElement.querySelector('.inv-counter__value');
          let val = parseInt(input.value) || 0;
          if (btn.dataset.action === 'add') val++;
          else if (btn.dataset.action === 'sub' && val > 0) val--;
          input.value = val;
          save();
        }, 80);
      }, 400);
    });
    function stopHold() {
      clearTimeout(holdTimer);
      clearInterval(holdInterval);
      holdTimer = null;
      holdInterval = null;
    }
    card.addEventListener('pointerup', stopHold);
    card.addEventListener('pointerleave', stopHold);
    card.addEventListener('pointercancel', stopHold);

    load();
  })();
  </script>



</div>



<!-- ============================================================ -->
<!-- Supabase CDN                                                  -->
<!-- ============================================================ -->
<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2/dist/umd/supabase.min.js"></script>

<!-- ============================================================ -->
<!-- ðŸ”¥ PRODUCTION TABLES â€” Supabase-backed flavor grids            -->
<!-- ============================================================ -->
<script>
(function() {
  var SUPA_URL = 'https://muowpjabnjkqgwgzfmoj.supabase.co';
  var SUPA_KEY = 'sb_publishable_e-Kx6L_hOKZaG1toGiKidw__weM4n7n';
  var sb = null;
  try { sb = supabase.createClient(SUPA_URL, SUPA_KEY); } catch(e) {}

  var FLAVORS = ['hot','mild','mango','truffle','sriracha','thai'];
  var COLORS = { hot:'#CC0000', mild:'#3BA226', mango:'#F5D623', truffle:'#1A1A1A', sriracha:'#2B6EC2', thai:'#F5D623' };

  function fmt(n) {
    if (n === 0) return 'â€”';
    return n.toLocaleString();
  }
  function cellClass(n, threshold) {
    if (n === 0) return 'cell-zero';
    if (n < 0) return 'cell-bad';
    if (threshold && n < threshold) return 'cell-warn';
    return '';
  }

  async function loadSettings(key) {
    if (!sb) return null;
    try {
      var res = await sb.from('settings').select('value').eq('key', key).single();
      return res.data ? res.data.value : null;
    } catch(e) { return null; }
  }

  async function loadAllOrders() {
    if (!sb) return [];
    try {
      var res = await sb.from('tango_orders').select('*').order('created_at');
      return res.data || [];
    } catch(e) { return []; }
  }

  async function boot() {
    var packed = await loadSettings('tango_production_packed');
    var drums = await loadSettings('tango_production_drums');
    var demand = await loadSettings('tango_production_demand');
    var allOrders = await loadAllOrders();

    if (!packed || !drums) {
      document.getElementById('snapshot-body').innerHTML = '<tr><td colspan="7" style="text-align:center;color:var(--muted);padding:24px;">No production data in Supabase yet.</td></tr>';
      return;
    }

    // â”€â”€ Build lookup maps â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    var packedMap = {};
    (packed.packed || []).forEach(function(p) { packedMap[p.flavor] = p.bottles || 0; });
    var drumsMap = {};
    (drums.drums || []).forEach(function(d) { drumsMap[d.flavor] = d; });

    // â”€â”€ TABLE 1: Flavor Snapshot â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    document.getElementById('snapshot-date').textContent = 'Updated ' + (packed.updated || '?');

    var rows = [
      { label: 'Packed Bottles', key: 'packed' },
      { label: '6-Packs (cases)', key: 'cases' },
      { label: 'Botes (drums)', key: 'drums' },
      { label: 'Total Once Packed', key: 'total' }
    ];

    var html = '';
    rows.forEach(function(row) {
      html += '<tr><td class="col-name" style="font-weight:600;">' + row.label + '</td>';
      FLAVORS.forEach(function(f) {
        var val = 0;
        if (row.key === 'packed') {
          val = packedMap[f] || 0;
        } else if (row.key === 'cases') {
          val = Math.floor((packedMap[f] || 0) / 6);
        } else if (row.key === 'drums') {
          val = drumsMap[f] ? drumsMap[f].drums : 0;
        } else if (row.key === 'total') {
          val = (packedMap[f] || 0) + (drumsMap[f] ? drumsMap[f].bottles_worth : 0);
        }
        var cls = val === 0 ? 'cell-zero' : '';
        html += '<td class="' + cls + '">' + fmt(val) + '</td>';
      });
      html += '</tr>';
    });
    document.getElementById('snapshot-body').innerHTML = html;

    // â”€â”€ TABLE 2: Order Demand â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    // Only show orders that have items (processing/new)
    var activeOrders = allOrders.filter(function(o) {
      return o.items && o.items.length > 0 && (o.stage === 'new' || o.stage === 'processing');
    });

    var demandTotals = {};
    FLAVORS.forEach(function(f) { demandTotals[f] = 0; });

    var dhtml = '';
    activeOrders.forEach(function(order) {
      var flavorMap = {};
      (order.items || []).forEach(function(item) {
        var key = item.flavor.toLowerCase();
        flavorMap[key] = (item.cases || 0) * 6;
      });

      dhtml += '<tr><td class="col-name" style="font-weight:600;">' + (order.channel || '') + '<br><span style="font-size:11px;color:var(--muted);">' + (order.title || '') + '</span></td>';
      FLAVORS.forEach(function(f) {
        var val = flavorMap[f] || 0;
        demandTotals[f] += val;
        var cls = val === 0 ? 'cell-zero' : '';
        dhtml += '<td class="' + cls + '">' + fmt(val) + '</td>';
      });
      dhtml += '</tr>';
    });

    // Add demand from non-order channels if we have demand data
    if (demand && demand.demand) {
      var extraRow = {};
      FLAVORS.forEach(function(f) { extraRow[f] = 0; });
      demand.demand.forEach(function(d) {
        var f = d.flavor;
        var orderDemand = demandTotals[f] || 0;
        var otherDemand = (d.amazon || 0) + (d.faire_dtc || 0) + (d.samples || 0);
        if (otherDemand > 0) extraRow[f] = otherDemand;
      });
      var hasExtras = FLAVORS.some(function(f) { return extraRow[f] > 0; });
      if (hasExtras) {
        dhtml += '<tr><td class="col-name" style="font-weight:600;">Amazon + Faire<br><span style="font-size:11px;color:var(--muted);">DTC + Samples</span></td>';
        FLAVORS.forEach(function(f) {
          var val = extraRow[f];
          demandTotals[f] += val;
          var cls = val === 0 ? 'cell-zero' : '';
          dhtml += '<td class="' + cls + '">' + fmt(val) + '</td>';
        });
        dhtml += '</tr>';
      }
    }

    // Totals row
    dhtml += '<tr class="row-total"><td>Total Need</td>';
    FLAVORS.forEach(function(f) {
      dhtml += '<td>' + fmt(demandTotals[f]) + '</td>';
    });
    dhtml += '</tr>';
    document.getElementById('demand-body').innerHTML = dhtml;

    // â”€â”€ TABLE 3: Gap Analysis â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    var ghtml = '';

    // Row 1: Total need
    ghtml += '<tr><td class="col-name" style="font-weight:600;">Total Need</td>';
    FLAVORS.forEach(function(f) {
      var cls = demandTotals[f] === 0 ? 'cell-zero' : '';
      ghtml += '<td class="' + cls + '">' + fmt(demandTotals[f]) + '</td>';
    });
    ghtml += '</tr>';

    // Row 2: Packed bottles (have)
    ghtml += '<tr><td class="col-name" style="font-weight:600;">Packed (have)</td>';
    FLAVORS.forEach(function(f) {
      var val = packedMap[f] || 0;
      var cls = val === 0 ? 'cell-zero' : 'cell-ok';
      ghtml += '<td class="' + cls + '">' + fmt(val) + '</td>';
    });
    ghtml += '</tr>';

    // Row 3: In drums
    ghtml += '<tr><td class="col-name" style="font-weight:600;">In Drums</td>';
    FLAVORS.forEach(function(f) {
      var val = drumsMap[f] ? drumsMap[f].bottles_worth : 0;
      var cls = val === 0 ? 'cell-zero' : 'cell-ok';
      ghtml += '<td class="' + cls + '">' + fmt(val) + '</td>';
    });
    ghtml += '</tr>';

    // Row 4: Gap (need - have - drums)
    ghtml += '<tr class="row-total"><td>Gap</td>';
    var gaps = {};
    FLAVORS.forEach(function(f) {
      var need = demandTotals[f];
      var have = (packedMap[f] || 0) + (drumsMap[f] ? drumsMap[f].bottles_worth : 0);
      var gap = need - have;
      gaps[f] = gap;
      var cls = '';
      if (gap <= 0) cls = 'cell-ok';
      else cls = 'cell-bad';
      ghtml += '<td class="' + cls + '">' + (gap <= 0 ? 'âœ… +' + fmt(Math.abs(gap)) : 'âŒ ' + fmt(gap)) + '</td>';
    });
    ghtml += '</tr>';
    document.getElementById('gap-body').innerHTML = ghtml;

    // â”€â”€ SECTION 4: Next Steps â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    var steps = [];

    // Check what needs cooking
    var needCook = [];
    FLAVORS.forEach(function(f) {
      if (gaps[f] > 0) needCook.push({ flavor: f, gap: gaps[f] });
    });
    if (needCook.length > 0) {
      var cookList = needCook.map(function(c) {
        return '<strong>' + c.flavor.charAt(0).toUpperCase() + c.flavor.slice(1) + '</strong> (' + fmt(c.gap) + ' bottles short)';
      }).join(', ');
      steps.push('Schedule cook day for: ' + cookList + '. Mon Feb 24 planned â€” 4hr cook shift ($400).');
    }

    // Check what needs packing from drums
    var needPack = [];
    FLAVORS.forEach(function(f) {
      var drumVal = drumsMap[f] ? drumsMap[f].bottles_worth : 0;
      if (drumVal > 0 && demandTotals[f] > (packedMap[f] || 0)) {
        var toPack = Math.min(drumVal, demandTotals[f] - (packedMap[f] || 0));
        needPack.push({ flavor: f, bottles: toPack });
      }
    });
    if (needPack.length > 0) {
      var packList = needPack.map(function(p) {
        return '<strong>' + p.flavor.charAt(0).toUpperCase() + p.flavor.slice(1) + '</strong> (' + fmt(p.bottles) + ')';
      }).join(', ');
      steps.push('Pack from drums: ' + packList + '. Thu Feb 27 planned â€” 4hr pack shift ($1,000).');
    }

    // Check Mild labels
    steps.push('Order more <strong>Mild labels</strong> â€” only ~500 left, need 180+ for EXP alone.');

    // EXP pickup
    steps.push('Contact <strong>Jason at EXP</strong> â€” push pickup to ~Feb 28 (was Feb 19). Ship complete, 140 cases.');

    // Count Hots
    steps.push('Do a real <strong>Hot bottle count</strong> next time at kitchen. Last confirmed: ~100 (Feb 17).');

    var shtml = '';
    steps.forEach(function(s, i) {
      shtml += '<div class="next-step-item"><span class="next-step-num">' + (i + 1) + '</span><span class="next-step-text">' + s + '</span></div>';
    });
    document.getElementById('next-steps').innerHTML = shtml;
  }

  boot();
})();
</script>

<!-- ============================================================ -->
<!-- ðŸ“¦ ORDERS PIPELINE â€” JavaScript (Supabase-backed)             -->
<!-- ============================================================ -->
<script>
(function() {
  // â”€â”€ Supabase config â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  var SUPA_URL = 'https://muowpjabnjkqgwgzfmoj.supabase.co';
  var SUPA_KEY = 'sb_publishable_e-Kx6L_hOKZaG1toGiKidw__weM4n7n';
  var sb = null;
  try { sb = supabase.createClient(SUPA_URL, SUPA_KEY); } catch(e) { console.warn('Supabase unavailable:', e); }

  var STORAGE_KEY = 'tango-orders';

  // â”€â”€ Default orders (seed data) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  var DEFAULT_ORDERS = [
    {
      id: 'exp-12165',
      channel: 'EXP Corp',
      title: 'PO #12165',
      value: '$3,750',
      date_str: 'Pickup: Feb 19',
      stage: 'processing',
      ship_to: 'EXP Warehouse, 28-13 119th St, College Point, NY 11354',
      notes: 'Corrected: Mango $25/case (was $5 typo on PO). Added 20 Sriracha (not on original PO). Mild bottles need cap swap (wrong color caps).',
      items: [
        { sku: 'TH01', flavor: 'Truffle',  cases: 10, price: 50, packed: 0 },
        { sku: 'TH02', flavor: 'Hot',      cases: 50, price: 25, packed: 10 },
        { sku: 'TH03', flavor: 'Mild',     cases: 30, price: 25, packed: 0 },
        { sku: 'TH04', flavor: 'Mango',    cases: 30, price: 25, packed: 0 },
        { sku: 'TH05', flavor: 'Sriracha', cases: 20, price: 25, packed: 0 }
      ],
      checklist: [
        { id: 'c1',  text: 'Swap Mild caps (garage \u2014 wrong color)', done: false, when: 'today' },
        { id: 'c2',  text: 'Haul bottles upstairs (all flavors except Sriracha shortage)', done: false, when: 'today' },
        { id: 'c3',  text: 'Tape bottoms on all 48 boxes', done: false, when: 'today' },
        { id: 'c4',  text: 'Fill + tape + sticker: 30 Mango cases', done: false, when: 'today' },
        { id: 'c5',  text: 'Fill + tape + sticker: 10 Truffle cases', done: false, when: 'today' },
        { id: 'c6',  text: 'Fill + tape + sticker: 8 Sriracha cases (48 bottles = all we have)', done: false, when: 'today' },
        { id: 'c7',  text: 'Get more boxes (need 92 more) \u2014 order or pick up', done: false, when: 'today' },
        { id: 'c8',  text: 'Pack 50 Hot cases (40 new + 10 already done at kitchen)', done: false, when: 'tomorrow' },
        { id: 'c9',  text: 'Pack 30 Mild cases', done: false, when: 'tomorrow' },
        { id: 'c10', text: 'Pack remaining 12 Sriracha cases (need 72 more bottles)', done: false, when: 'tomorrow' },
        { id: 'c11', text: 'Palletize all 140 cases', done: false, when: 'tomorrow' },
        { id: 'c12', text: 'Generate BOL', done: false, when: 'tomorrow' },
        { id: 'c13', text: 'Confirm pickup time with EXP', done: false, when: 'tomorrow' }
      ],
      docs: {
        po:  '/distribution/exp/PO-12165/PO12165 TANGO.pdf',
        bol: '/distribution/exp/PO-12165/BOL-12165.pdf',
        inv: null
      }
    },
    {
      id: 'unfi-044849783',
      channel: 'UNFI Moreno Valley',
      title: 'PO #044849783',
      value: '$3,422',
      date_str: 'Pickup: Feb 9',
      stage: 'shipped',
      docs: {
        po:  '/distribution/unfi/purchase-orders/po-044849783/PO044849783.html',
        bol: '/distribution/unfi/purchase-orders/po-044849783/BOL-044849783.pdf',
        inv: null
      }
    },
    {
      id: 'unfi-1052998',
      channel: 'UNFI Hudson Valley',
      title: 'PO #1052998',
      value: '$3,422',
      date_str: 'Pickup: Feb 25',
      stage: 'processing',
      docs: {
        po:  '/distribution/unfi/purchase-orders/po-1052998/PO1052998.pdf',
        bol: '/distribution/unfi/purchase-orders/po-1052998/BOL-1052998.pdf',
        inv: '/business/UNFI_Invoice_203_PO1052998.md'
      }
    }
  ];

  // â”€â”€ DB helpers â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  // Convert DB row (snake_case) â†’ app object (camelCase-ish for display)
  function rowToOrder(row) {
    return {
      id: row.id,
      channel: row.channel,
      title: row.title,
      value: row.value,
      date: row.date_str,
      stage: row.stage,
      shipTo: row.ship_to,
      notes: row.notes,
      items: row.items || [],
      checklist: row.checklist || [],
      docs: row.docs || {}
    };
  }

  // Convert app object â†’ DB row
  function orderToRow(order) {
    return {
      id: order.id,
      channel: order.channel,
      title: order.title,
      value: order.value,
      date_str: order.date || order.date_str,
      stage: order.stage,
      ship_to: order.shipTo || order.ship_to,
      notes: order.notes,
      items: order.items || [],
      checklist: order.checklist || [],
      docs: order.docs || {},
      updated_at: new Date().toISOString()
    };
  }

  // â”€â”€ Load from Supabase (with localStorage cache) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  var orders = [];

  async function loadOrders() {
    // Try Supabase first
    if (sb) {
      try {
        var res = await sb.from('tango_orders').select('*').order('created_at');
        if (res.data && res.data.length > 0) {
          orders = res.data.map(rowToOrder);
          localStorage.setItem(STORAGE_KEY, JSON.stringify(orders));
          render();
          return;
        }
        // Table empty â€” seed it
        var rows = DEFAULT_ORDERS.map(orderToRow);
        await sb.from('tango_orders').upsert(rows);
        orders = DEFAULT_ORDERS.map(function(d) { return rowToOrder(orderToRow(d)); });
        localStorage.setItem(STORAGE_KEY, JSON.stringify(orders));
        render();
        return;
      } catch(e) {
        console.warn('Supabase load failed, using cache:', e);
      }
    }
    // Fallback to localStorage
    try {
      var raw = localStorage.getItem(STORAGE_KEY);
      orders = raw ? JSON.parse(raw) : DEFAULT_ORDERS.map(function(d) { return rowToOrder(orderToRow(d)); });
    } catch(e) {
      orders = DEFAULT_ORDERS.map(function(d) { return rowToOrder(orderToRow(d)); });
    }
    render();
  }

  // â”€â”€ Save single order â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  function saveOrder(order) {
    // Update localStorage cache
    localStorage.setItem(STORAGE_KEY, JSON.stringify(orders));
    // Persist to Supabase (fire and forget)
    if (sb) {
      sb.from('tango_orders').upsert(orderToRow(order)).then(function(res) {
        if (res.error) console.warn('Supabase save error:', res.error);
      });
    }
  }

  // â”€â”€ Render â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  function render() {
    var drops = document.querySelectorAll('.pipeline-col__drop');
    drops.forEach(function(d) { d.innerHTML = ''; });

    var stages = { new: 0, processing: 0, shipped: 0, paid: 0 };

    orders.forEach(function(order) {
      stages[order.stage] = (stages[order.stage] || 0) + 1;

      var card = document.createElement('div');
      card.className = 'pipe-card';
      card.draggable = true;
      card.dataset.id = order.id;

      var docsObj = order.docs || {};
      var docsHTML = ['po','bol','inv'].map(function(type) {
        var label = type === 'po' ? 'PO' : type === 'bol' ? 'BOL' : 'Invoice';
        if (docsObj[type]) {
          return '<a class="pipe-card__doc" href="javascript:void(0)" data-doc="' + type + '" data-order="' + order.id + '" title="Export ' + label + '">' + label + '</a>';
        } else {
          return '<span class="pipe-card__doc pipe-card__doc--missing" title="No ' + label + ' yet">' + label + '</span>';
        }
      }).join('');

      card.innerHTML =
        '<div class="pipe-card__channel">' + (order.channel || '') + '</div>' +
        '<div class="pipe-card__title">' + (order.title || '') + '</div>' +
        '<div class="pipe-card__value">' + (order.value || '') + '</div>' +
        '<div class="pipe-card__date">' + (order.date || '') + '</div>' +
        '<div class="pipe-card__docs">' + docsHTML + '</div>';

      var drop = document.querySelector('[data-drop="' + order.stage + '"]');
      if (drop) drop.appendChild(card);
    });

    // Update counts
    document.querySelectorAll('.pipeline-col').forEach(function(col) {
      var stage = col.dataset.stage;
      var countEl = col.querySelector('[data-count]');
      if (countEl) countEl.textContent = stages[stage] || 0;
    });
  }

  // â”€â”€ Drag & Drop â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  var dragId = null;

  document.getElementById('orders-pipeline').addEventListener('dragstart', function(e) {
    var card = e.target.closest('.pipe-card');
    if (!card) return;
    dragId = card.dataset.id;
    card.classList.add('dragging');
    e.dataTransfer.effectAllowed = 'move';
  });

  document.getElementById('orders-pipeline').addEventListener('dragend', function(e) {
    var card = e.target.closest('.pipe-card');
    if (card) card.classList.remove('dragging');
    document.querySelectorAll('.drag-over').forEach(function(el) { el.classList.remove('drag-over'); });
    dragId = null;
  });

  document.querySelectorAll('.pipeline-col__drop').forEach(function(drop) {
    drop.addEventListener('dragover', function(e) {
      e.preventDefault();
      e.dataTransfer.dropEffect = 'move';
      drop.classList.add('drag-over');
    });
    drop.addEventListener('dragleave', function() {
      drop.classList.remove('drag-over');
    });
    drop.addEventListener('drop', function(e) {
      e.preventDefault();
      drop.classList.remove('drag-over');
      if (!dragId) return;
      var newStage = drop.dataset.drop;
      var order = orders.find(function(o) { return o.id === dragId; });
      if (order && order.stage !== newStage) {
        order.stage = newStage;
        saveOrder(order);
        render();
      }
    });
  });

  // â”€â”€ Document export (open file) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  function showToast(msg) {
    var toast = document.createElement('div');
    toast.textContent = msg;
    toast.style.cssText = 'position:fixed;bottom:24px;left:50%;transform:translateX(-50%);background:#222;color:#fff;padding:12px 24px;border-radius:12px;font-size:13px;z-index:9999;box-shadow:0 4px 24px rgba(0,0,0,.4);opacity:0;transition:opacity .2s';
    document.body.appendChild(toast);
    requestAnimationFrame(function() { toast.style.opacity = '1'; });
    setTimeout(function() {
      toast.style.opacity = '0';
      setTimeout(function() { toast.remove(); }, 300);
    }, 2500);
  }

  document.getElementById('orders-pipeline').addEventListener('click', function(e) {
    var docBtn = e.target.closest('.pipe-card__doc[data-doc]');
    if (!docBtn) return;
    e.preventDefault();
    e.stopPropagation();
    var orderId = docBtn.dataset.order;
    var docType = docBtn.dataset.doc;
    var order = orders.find(function(o) { return o.id === orderId; });
    if (!order || !order.docs[docType]) return;

    var fullPath = '/Projects/\uD83D\uDD25 tango' + order.docs[docType];

    navigator.clipboard.writeText(fullPath).then(function() {
      showToast('\uD83D\uDCCB Copied: ' + fullPath.split('/').pop());
    }).catch(function() {
      prompt('Document path:', fullPath);
    });
  });

  // â”€â”€ Click card to open order detail â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  var clickStartX, clickStartY;
  document.getElementById('orders-pipeline').addEventListener('mousedown', function(e) {
    clickStartX = e.clientX;
    clickStartY = e.clientY;
  });
  document.getElementById('orders-pipeline').addEventListener('click', function(e) {
    if (Math.abs(e.clientX - clickStartX) > 5 || Math.abs(e.clientY - clickStartY) > 5) return;
    if (e.target.closest('.pipe-card__doc')) return;
    var card = e.target.closest('.pipe-card');
    if (!card) return;
    window.location.href = 'order.html?id=' + card.dataset.id;
  });

  // â”€â”€ Touch support for mobile drag â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  var touchCard = null;
  var touchClone = null;
  var touchStartX, touchStartY;

  document.getElementById('orders-pipeline').addEventListener('touchstart', function(e) {
    var card = e.target.closest('.pipe-card');
    if (!card || e.target.closest('.pipe-card__doc')) return;
    touchCard = card;
    dragId = card.dataset.id;
    var rect = card.getBoundingClientRect();
    touchStartX = e.touches[0].clientX - rect.left;
    touchStartY = e.touches[0].clientY - rect.top;

    touchClone = card.cloneNode(true);
    touchClone.style.position = 'fixed';
    touchClone.style.width = rect.width + 'px';
    touchClone.style.opacity = '0.85';
    touchClone.style.zIndex = '9999';
    touchClone.style.pointerEvents = 'none';
    touchClone.style.transform = 'scale(1.04)';
    touchClone.style.boxShadow = '0 12px 40px rgba(0,0,0,0.3)';
    document.body.appendChild(touchClone);

    card.classList.add('dragging');
  }, { passive: true });

  document.addEventListener('touchmove', function(e) {
    if (!touchClone) return;
    var x = e.touches[0].clientX - touchStartX;
    var y = e.touches[0].clientY - touchStartY;
    touchClone.style.left = x + 'px';
    touchClone.style.top = y + 'px';

    document.querySelectorAll('.drag-over').forEach(function(el) { el.classList.remove('drag-over'); });
    var el = document.elementFromPoint(e.touches[0].clientX, e.touches[0].clientY);
    if (el) {
      var drop = el.closest('.pipeline-col__drop');
      if (drop) drop.classList.add('drag-over');
    }
  }, { passive: true });

  document.addEventListener('touchend', function(e) {
    if (!touchClone) return;
    document.querySelectorAll('.drag-over').forEach(function(el) { el.classList.remove('drag-over'); });

    var touch = e.changedTouches[0];
    touchClone.style.display = 'none';
    var el = document.elementFromPoint(touch.clientX, touch.clientY);
    touchClone.style.display = '';
    if (el) {
      var drop = el.closest('.pipeline-col__drop');
      if (drop && dragId) {
        var newStage = drop.dataset.drop;
        var order = orders.find(function(o) { return o.id === dragId; });
        if (order && order.stage !== newStage) {
          order.stage = newStage;
          saveOrder(order);
        }
      }
    }

    if (touchCard) touchCard.classList.remove('dragging');
    if (touchClone && touchClone.parentNode) touchClone.parentNode.removeChild(touchClone);
    touchCard = null;
    touchClone = null;
    dragId = null;
    render();
  });

  // â”€â”€ Boot â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  // Render cached/defaults immediately so page is never blank
  try {
    var raw = localStorage.getItem(STORAGE_KEY);
    orders = raw ? JSON.parse(raw) : DEFAULT_ORDERS.map(function(d) { return rowToOrder(orderToRow(d)); });
  } catch(e) {
    orders = DEFAULT_ORDERS.map(function(d) { return rowToOrder(orderToRow(d)); });
  }
  render();
  // Then sync from Supabase in background
  loadOrders();
})();
</script>


<!-- Service Worker Registration -->
<script>
if ('serviceWorker' in navigator) {
  navigator.serviceWorker.register('./sw.js').then(function(reg) {
    reg.update();
  });
}
</script>

</body>
</html>
